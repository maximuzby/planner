(window.webpackJsonpplanner=window.webpackJsonpplanner||[]).push([[0],{58:function(e,t,n){e.exports=n(94)},89:function(e,t,n){},90:function(e,t,n){},91:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);n(59);var a=n(0),r=n.n(a),c=n(15),o=n.n(c),i=n(102),s=n(100),l=n(97),u=n(17),d=n(8),f=n(96),m=n(103),p=n(101),y=n(7),v=n(52),g=n.n(v),h=n(25),k=n.n(h),b=function(e){return e.isoWeekday()<=6},E=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})},x=y.types.model("Entity",{id:y.types.optional(y.types.identifier,E)}),w=x.named("Day").props({date:y.types.string,title:y.types.string}).views(function(e){return{get isWeekend(){return b(k()(e.date))}}}).actions(function(e){return{setTitle:function(t){return e.title=t}}}),D=x.named("Person").props({name:y.types.string}).actions(function(e){return{setName:function(t){return e.name=t}}}),O=x.named("Task").props({name:y.types.string,startDay:y.types.number,person:y.types.reference(D),length:y.types.optional(y.types.number,1)}).views(function(e){return{get finishDay(){return e.startDay+e.length-1}}}).views(function(e){return{starts:function(t){return e.startDay===t},finishes:function(t){return e.finishDay===t},inDay:function(t){return t>=e.startDay&&t<=e.finishDay},intersects:function(t){return e.startDay>=t.startDay&&e.startDay<=t.finishDay||e.finishDay>=t.startDay&&e.finishDay<=t.finishDay||t.startDay>=e.startDay&&t.startDay<=e.finishDay||t.finishDay>=e.startDay&&t.finishDay<=e.finishDay}}}).actions(function(e){return{setName:function(t){return e.name=t},moveTo:function(t,n,a){e.startDay=e.startDay+(n-t),e.person=a},increaseLength:function(){return e.length++},decreaseLength:function(){return e.length>1&&!!e.length--}}}),j=n(32),T=y.types.model("PlannerApp",{people:y.types.array(D),days:y.types.array(w),tasks:y.types.array(O),selectedTaskId:y.types.maybe(y.types.string)}).views(function(e){return{get selectedTask(){return e.tasks.find(function(t){return t.id===e.selectedTaskId})},getPersonTasks:function(t){return e.tasks.filter(function(e){return e.person===t}).sort(function(e,t){return e.startDay-t.startDay}).reduce(function(e,t){var n=e.filter(function(e){return e.task.intersects(t)}).map(function(e){return e.position}).sort().reduce(function(e,t){return t===e?e+1:e},0);return[].concat(Object(j.a)(e),[{task:t,position:n}])},[])}}}).views(function(e){return{getTaskPlacements:function(t,n){return e.getPersonTasks(n).filter(function(e){return e.task.inDay(t)})}}}).actions(function(e){return{selectTask:function(t){e.selectedTaskId=t.id}}}).actions(function(e){return{removeTask:function(t){t.id===e.selectedTaskId&&(e.selectedTaskId=void 0),e.tasks.remove(t)},addDay:function(){var t=k()(e.days[e.days.length-1].date).add(1,"day");e.days.push({title:t.format("ddd, MMM D"),date:t.format()})},addTask:function(t,n){var a=O.create({person:n.id,startDay:t,name:""});e.tasks.push(a),e.selectTask(a)},addPerson:function(){e.people.push({name:"Anonymous"})},afterCreate:function(){return function(e){if(!(e.days.length>0)){for(var t=0;t<7;t++){var n=k()().startOf("date").add(t,"day");e.days.push({title:n.format("ddd, MMM D"),date:n.format()})}e.people=Object(y.cast)([{name:"John"},{name:"Max"}])}}(e)}}}),N=r.a.createContext(null);function P(){var e=T.create({});return g()(e),e}var C=function(e){var t=e.children,n=Object(d.a)(P);return r.a.createElement(N.Provider,{value:n},t)},I=function(){var e=r.a.useContext(N);if(!e)throw new Error("You have forgot to use StoreProvider, shame on you.");return e},S=function(){var e=I(),t=Object(a.useState)(!1),n=Object(u.a)(t,2),c=n[0],o=n[1],i=Object(a.useState)(""),s=Object(u.a)(i,2),l=s[0],v=s[1],g=Object(a.useState)(""),h=Object(u.a)(g,2),k=h[0],b=h[1],E=function(){return o(!1)},x=function(e,t){v(t),b(e),o(!0)},w=function(){var t=JSON.parse(localStorage.getItem("savedPlan")||"");try{Object(y.applySnapshot)(e,t),x("Loaded","Plan is loaded from storage!")}catch(a){var n="Error while loading data from storage";console.error(n,a),x("Error",n)}},D=function(){var t=Object(y.getSnapshot)(e),n=JSON.stringify(t);localStorage.setItem("savedPlan",n),x("Saved","Current Plan is saved!")};return Object(d.b)(function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(f.a,null,r.a.createElement(m.a,{variant:"outline-danger",onClick:w,title:"Load"},"Load"),r.a.createElement(m.a,{variant:"outline-success",onClick:D,title:"Save"},"Save")),r.a.createElement(p.a,{show:c,onHide:E},r.a.createElement(p.a.Header,{closeButton:!0},r.a.createElement(p.a.Title,null,k)),r.a.createElement(p.a.Body,null,l),r.a.createElement(p.a.Footer,null,r.a.createElement(m.a,{variant:"primary",onClick:E},"OK"))))})},A=n(27),M=n(57),L=n(98),W=function(e){var t=e.setValue,n=e.value,c=e.classNamePrefix,o=e.onBlur,i=Object(a.useCallback)(function(e){t(e.target.value)},[t]);return Object(d.b)(function(){return r.a.createElement("input",{autoFocus:!0,onBlur:o,className:"".concat(c,"-cell-editor"),value:n,type:"text",onChange:i})})},B=function(e){var t=Object(a.useState)(!1),n=Object(u.a)(t,2),c=n[0],o=n[1],i=Object(a.useCallback)(function(){o(!0)},[]),s=Object(a.useCallback)(function(){o(!1)},[]);return Object(d.b)(function(){return r.a.createElement("th",{className:"planner-cell planner-cell_header ".concat(e.classNamePrefix,"-cell"),onClick:i},c?r.a.createElement(W,Object.assign({},e,{onBlur:s})):r.a.createElement("div",{className:"".concat(e.classNamePrefix,"-cell-text")},e.value))})},F=(n(89),function(e){var t=e.person;return Object(d.b)(function(){return r.a.createElement(B,{value:t.name,setValue:t.setName,classNamePrefix:"person"})})}),_=(n(90),function(e){return Object(d.b)(function(){return r.a.createElement(B,{value:e.day.title,setValue:e.day.setTitle,classNamePrefix:"day"})})}),J=function(){var e=I();return Object(d.b)(function(){return r.a.createElement("tr",{className:"planner-table__header"},r.a.createElement("th",{className:"planner-cell planner-cell_header"}),e.days.map(function(e){return r.a.createElement(_,{key:e.id,day:e})}),r.a.createElement("th",{className:"planner-cell planner-cell_add"},r.a.createElement(m.a,{variant:"outline-primary",onClick:e.addDay,title:"Add Day"},"Add Day")))})},R=n(5),U=n.n(R),V=function(e){var t=e.task,n=e.dayIndex,a=I(),c=Object(A.c)({item:{task:t,type:"card",fromIndex:n},collect:function(e){return{isDragging:!!e.isDragging()}}}),o=Object(u.a)(c,2),i=o[0].isDragging,s=o[1],l=function(){a.selectTask(t)},p=function(){t.decreaseLength()||a.removeTask(t)};return Object(d.b)(function(){return r.a.createElement("div",{ref:s,style:{opacity:i?.5:1},className:U()("planner-card","card-task",{"task-start":t.starts(n),"task-finish":t.finishes(n),"task-selected":a.selectedTaskId===t.id}),onClick:l},t.name," ",r.a.createElement(f.a,{className:"task-length-buttons"},r.a.createElement(m.a,{size:"sm",variant:"outline-warning",onClick:t.increaseLength},"+"),r.a.createElement(m.a,{size:"sm",variant:"outline-warning",onClick:p},"-")))})},z=function(){return r.a.createElement("div",{className:"planner-card empty-card"},"")},H=function(e){var t=e.taskPlacements,n=e.dayIndex,a=Math.max.apply(Math,Object(j.a)(t.map(function(e){return e.position}))),c=Array.from({length:a+1},function(e,n){return t.find(function(e){return e.position===n})});return r.a.createElement(r.a.Fragment,null,c.map(function(e,t){return e?r.a.createElement(V,{dayIndex:n,task:e.task,key:e.task.id}):r.a.createElement(z,{key:t})}))},K=function(e){var t=e.dayIndex,n=e.person,c=Object(A.d)({accept:"card",drop:function(t){return t.task.moveTo(t.fromIndex,e.dayIndex,e.person),{}}}),o=Object(u.a)(c,2)[1],i=I(),s=Object(a.useCallback)(function(){i.addTask(t,n)},[t,n,i]);return Object(d.b)(function(){var n=i.getTaskPlacements(e.dayIndex,e.person);return r.a.createElement("td",{ref:o,className:"planner-cell planner-cell_task"},0===n.length?r.a.createElement("div",{className:"planner-card empty-card",onClick:s},"Free"):r.a.createElement(H,{taskPlacements:n,dayIndex:t}))})},Y=function(e){var t=e.person,n=I();return Object(d.b)(function(){return r.a.createElement("tr",{className:"planner-table__row"},r.a.createElement(F,{person:t}),n.days.map(function(e,n){return r.a.createElement(K,{key:n,dayIndex:n,person:t})}))})},$=(n(91),function(){var e=I();return Object(d.b)(function(){return r.a.createElement(r.a.Fragment,null,e.people.map(function(e){return r.a.createElement(Y,{person:e,key:e.id})}))})}),q=function(){return r.a.createElement(l.a,null,r.a.createElement(L.a,{lg:"12"},r.a.createElement(A.b,{backend:M.a},r.a.createElement("table",{className:"planner-table"},r.a.createElement("thead",null,r.a.createElement(J,null)),r.a.createElement("tbody",null,r.a.createElement($,null))))))},G=function(){var e=I();return Object(d.b)(function(){return r.a.createElement(L.a,{sm:"4"},r.a.createElement(m.a,{variant:"outline-primary",onClick:e.addPerson,title:"Add Person"},"Add Person"))})},Q=n(99),X=n(104),Z=function(e){var t=e.task,n=function(e){t.setName(e.currentTarget.value||"")};return Object(d.b)(function(){return r.a.createElement(Q.a,null,r.a.createElement(X.a,{autoFocus:!0,value:t.name,onChange:n}))})},ee=function(){var e=I();return Object(d.b)(function(){return r.a.createElement(L.a,{sm:"8",md:"6",lg:"4"},e.selectedTask&&r.a.createElement(Z,{task:e.selectedTask}))})},te=function(e){var t=e.children;return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{fixed:"top",bg:"dark",variant:"dark",expand:"lg"},r.a.createElement(i.a.Brand,{href:"#home"},"Planner"),r.a.createElement(S,null)),r.a.createElement(s.a,{fluid:!0},t))},ne=(n(93),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function ae(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(function(){return r.a.createElement(C,null,r.a.createElement(te,null,r.a.createElement(q,null),r.a.createElement(l.a,null,r.a.createElement(G,null),r.a.createElement(ee,null))))},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/planner",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/planner","/service-worker.js");ne?(!function(e,t){fetch(e).then(function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):ae(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):ae(t,e)})}}()}},[[58,1,2]]]);
//# sourceMappingURL=main.2013c7db.chunk.js.map