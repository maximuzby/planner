(window.webpackJsonpplanner=window.webpackJsonpplanner||[]).push([[0],{36:function(e,n,t){e.exports=t(62)},49:function(e,n,t){},50:function(e,n,t){},51:function(e,n,t){},61:function(e,n,t){},62:function(e,n,t){"use strict";t.r(n);t(37);var a=t(0),r=t.n(a),c=t(18),o=t.n(c),i=t(67),s=t(65),l=t(66),u=t(9),d=t(68),f=t(16),m=t(34),p=t(31),y=t.n(p),h=t(5),v=t(15),g=t.n(v),k=function(e){return e.isoWeekday()<=6},x=function(){var e=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-xxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===n?t:3&t|8).toString(16)})},b=h.types.model("Entity",{id:h.types.optional(h.types.identifier,x)}),E=b.named("Day").props({date:h.types.string,title:h.types.string}).views(function(e){return{get isWeekend(){return k(g()(e.date))}}}).actions(function(e){return{setTitle:function(n){return e.title=n}}}),D=b.named("Person").props({name:h.types.string}).actions(function(e){return{setName:function(n){return e.name=n}}}),w=b.named("Task").props({name:h.types.string,startDay:h.types.number,person:h.types.reference(D),length:h.types.optional(h.types.number,1)}).views(function(e){return{get finishDay(){return e.startDay+e.length-1}}}).views(function(e){return{starts:function(n){return e.startDay===n},finishes:function(n){return e.finishDay===n},inDay:function(n){return n>=e.startDay&&n<=e.finishDay},intersects:function(n){return e.startDay>=n.startDay&&e.startDay<=n.finishDay||e.finishDay>=n.startDay&&e.finishDay<=n.finishDay||n.startDay>=e.startDay&&n.startDay<=e.finishDay||n.finishDay>=e.startDay&&n.finishDay<=e.finishDay}}}).actions(function(e){return{setName:function(n){return e.name=n},moveTo:function(n,t,a){e.startDay=e.startDay+(t-n),e.person=a},increaseLength:function(){return e.length++},decreaseLength:function(){e.length>1?e.length--:Object(h.getParentOfType)(e,O).removeTask(e)}}}),O=h.types.model("PlannerApp",{people:h.types.array(D),days:h.types.array(E),tasks:h.types.array(w)}).views(function(e){return{getPersonTasks:function(n){return function(e){var n=[];e.sort(function(e,n){return e.startDay-n.startDay});var t=!0,a=!1,r=void 0;try{for(var c,o=function(){for(var e=c.value,t=0;n.find(function(n){return n.position===t&&n.task.intersects(e)});)t++;n.push({task:e,position:t})},i=e[Symbol.iterator]();!(t=(c=i.next()).done);t=!0)o()}catch(s){a=!0,r=s}finally{try{t||null==i.return||i.return()}finally{if(a)throw r}}return n}(e.tasks.filter(function(e){return e.person===n}))}}}).views(function(e){return{getTaskPlacements:function(n,t){return e.getPersonTasks(t).filter(function(e){return e.task.inDay(n)})}}}).actions(function(e){return{removeTask:function(e){Object(h.detach)(e)},addDay:function(){var n=g()(e.days[e.days.length-1].date).add(1,"day");e.days.push({title:n.format("ddd, MMM D"),date:n.format()})},addTask:function(n,t){e.tasks.push(w.create({person:t.id,startDay:n,name:"Task X"}))},addPerson:function(){e.people.push({name:" "})},afterCreate:function(){for(var n=0;n<7;n++){var t=g()().startOf("date").add(n,"day");e.days.push({title:t.format("ddd, MMM D"),date:t.format()})}e.people=Object(h.cast)([{name:"John"},{name:"Max"}]),e.tasks=Object(h.cast)([{name:"Task 1",startDay:0,person:e.people[0].id},{name:"Task 2",startDay:1,person:e.people[0].id},{name:"Task 3",startDay:1,person:e.people[1].id}])}}}),j=r.a.createContext(null);function N(){var e=O.create({});return y()(e),e}var P=function(e){var n=e.children,t=Object(u.a)(N);return r.a.createElement(j.Provider,{value:t},n)},T=function(){var e=r.a.useContext(j);if(!e)throw new Error("You have forgot to use StoreProvider, shame on you.");return e},C=t(35),A=t(17),I=t(64),M=function(e){var n=e.task,t=e.dayIndex,a=Object(f.c)({item:{task:n,type:"card",fromIndex:t},collect:function(e){return{isDragging:!!e.isDragging()}}}),c=Object(A.a)(a,2),o=c[0].isDragging,i=c[1];return Object(u.b)(function(){return r.a.createElement("div",{ref:i,style:{opacity:o?.5:1},className:"planner-card card-task ".concat(n.starts(t)&&"task-start"," ").concat(n.finishes(t)&&"task-finish")},n.name," ",r.a.createElement(I.a,null,r.a.createElement(d.a,{size:"sm",variant:"primary",onClick:n.increaseLength},"+"),r.a.createElement(d.a,{size:"sm",variant:"primary",onClick:n.decreaseLength},"-")))})},_=function(){return r.a.createElement("div",{className:"planner-card empty-card"},"")},W=function(e){var n=e.taskPlacements,t=e.dayIndex,a=Math.max.apply(Math,Object(C.a)(n.map(function(e){return e.position}))),c=Array(a+1).fill(null).map(function(e,t){return n.find(function(e){return e.position===t})});return r.a.createElement(r.a.Fragment,null,c.map(function(e){return e?r.a.createElement(M,{dayIndex:t,task:e.task,key:e.task.id}):r.a.createElement(_,null)}))},S=function(e){var n=e.dayIndex,t=e.person,c=Object(f.d)({accept:"card",drop:function(n){return n.task.moveTo(n.fromIndex,e.dayIndex,e.person),{}}}),o=Object(A.a)(c,2)[1],i=T(),s=Object(a.useCallback)(function(){i.addTask(n,t)},[n,t,i]);return Object(u.b)(function(){var t=i.getTaskPlacements(e.dayIndex,e.person);return r.a.createElement("td",{ref:o,className:"planner-cell planner-cell_task"},0===t.length?r.a.createElement("div",{className:"planner-card empty-card",onClick:s},"Free"):r.a.createElement(W,{taskPlacements:t,dayIndex:n}))})},B=(t(49),function(e){var n=e.setValue,t=e.value,c=e.classNamePrefix,o=e.onBlur,i=Object(a.useCallback)(function(e){n(e.target.value)},[n]);return Object(u.b)(function(){return r.a.createElement("input",{autoFocus:!0,onBlur:o,className:"".concat(c,"-cell-editor"),value:t,type:"text",onChange:i})})}),L=function(e){var n=Object(a.useState)(!1),t=Object(A.a)(n,2),c=t[0],o=t[1],i=Object(a.useCallback)(function(){o(!0)},[]),s=Object(a.useCallback)(function(){o(!1)},[]);return Object(u.b)(function(){return r.a.createElement("th",{className:"planner-cell planner-cell_header ".concat(e.classNamePrefix,"-cell"),onClick:i},c?r.a.createElement(B,Object.assign({},e,{onBlur:s})):r.a.createElement("div",{className:"".concat(e.classNamePrefix,"-cell-text")},e.value))})},F=function(e){return Object(u.b)(function(){return r.a.createElement(L,{value:e.day.title,setValue:e.day.setTitle,classNamePrefix:"day"})})},J=(t(50),function(e){var n=e.person;return Object(u.b)(function(){return r.a.createElement(L,{value:n.name,setValue:n.setName,classNamePrefix:"person"})})}),R=(t(51),function(){var e=T();return r.a.createElement(f.b,{backend:m.a},Object(u.b)(function(){return r.a.createElement("table",{className:"planner-table"},r.a.createElement("tbody",null,r.a.createElement("tr",{className:"planner-table__header"},r.a.createElement("th",{className:"planner-cell planner-cell_header"}),e.days.map(function(e){return r.a.createElement(F,{key:e.id,day:e})}),r.a.createElement("th",{className:"planner-cell planner-cell_add"},r.a.createElement(d.a,{variant:"primary",onClick:e.addDay,title:"Add Day"},"Add"))),e.people.map(function(n){return r.a.createElement("tr",{className:"planner-table__row",key:n.id},r.a.createElement(J,{person:n}),e.days.map(function(e,t){return r.a.createElement(S,{key:t,dayIndex:t,person:n})}))}),r.a.createElement("tr",{className:"planner-table__row"},r.a.createElement("td",{className:"planner-cell planner-cell_add"},r.a.createElement(d.a,{variant:"primary",onClick:e.addPerson,title:"Add Person"},"Add")))))}))}),U=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{fixed:"top",bg:"dark",variant:"dark",expand:"lg"},r.a.createElement(i.a.Brand,{href:"#home"},"Planner")),r.a.createElement(s.a,{fluid:!0},r.a.createElement(l.a,null,e.children)))},V=(t(61),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/)));function z(e,n){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),n&&n.onUpdate&&n.onUpdate(e)):(console.log("Content is cached for offline use."),n&&n.onSuccess&&n.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}o.a.render(r.a.createElement(function(){return r.a.createElement(P,null,r.a.createElement(U,null,r.a.createElement(R,null)))},null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/planner",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var n="".concat("/planner","/service-worker.js");V?(!function(e,n){fetch(e).then(function(t){var a=t.headers.get("content-type");404===t.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):z(e,n)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(n,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")})):z(n,e)})}}()}},[[36,1,2]]]);
//# sourceMappingURL=main.a4705ba3.chunk.js.map